steps:
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build','-t','us-central1-docker.pkg.dev/$PROJECT_ID/jason-100959264/app:$COMMIT_SHA','.']
  - name: 'gcr.io/cloud-builders/docker'
    args: ['push','us-central1-docker.pkg.dev/$PROJECT_ID/jason-100959264/app:$COMMIT_SHA']
  - name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
    entrypoint: gcloud
    args: [
      'run','deploy','jason-100959264-svc',
      '--image','us-central1-docker.pkg.dev/$PROJECT_ID/jason-100959264/app:$COMMIT_SHA',
      '--platform','managed','--region','us-central1',
      '--allow-unauthenticated','--port','3000'
    ]

options:
  defaultLogsBucketBehavior: REGIONAL_USER_OWNED_BUCKET
